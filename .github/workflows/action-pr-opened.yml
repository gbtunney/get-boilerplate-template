name: Changeset Pull Request Opened
on:
    pull_request_target:
        types:
            - opened
        branches:
            - 'changeset/**'
        paths:
            - './.changeset/*.md'
            - '!./.changeset/README.md'
        workflow_dispatch:
jobs:
    if_merged:
        #if: github.event.pull_request
        runs-on: ubuntu-latest

        permissions:
            # Give the default GITHUB_TOKEN write permission to commit and push the changed files back to the repository.
            contents: write
            pull-request: write
            # Steps represent a sequence of tasks that will be executed as part of the job
            steps:
                # Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it
                - run: echo 'Build Monorepo 🐌';

                - name: Checkout 🛎️
                  uses: actions/checkout@v3
                  with:
                      ref: ${{ github.head_ref }}

                - run: |
                      echo The PR was OPENED!

                - name: Setup Node.js environment 🛎️
                  uses: actions/setup-node@v3.8.1

                - name: Install pnpm 🔧 # This example project is built using npm and outputs the result to the 'build' folder. Replace with the commands required to build your project, or remove this step entirely if your site is pre-built.
                  run: |
                      npm install -g pnpm
                      pnpm install

                - name: BUILD ALL PACKAGES
                  run: |
                      pnpm run build && pnpm run fix && pnpm run check

                - run: echo "🍏 This job's status is ${{ job.status }}."
